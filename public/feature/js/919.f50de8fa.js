"use strict";(self["webpackChunkfeature"]=self["webpackChunkfeature"]||[]).push([[919],{24943:function(e,t,a){var n=a(72505),u=a.n(n);const s=u().create({baseURL:"https://rubick.vip/api/"});t.A={async getScanCode({scene:e}){const t=await s.get("/users/getScanCode",{params:{scene:e}});return t.data},async checkLoginStatus({scene:e}){const t=await s.post("/users/checkLoginStatus",{scene:e});return t.data},async getUserInfo({openId:e}){const t=await s.post("/users/getUserInfo",{openId:e});return t.data}}},44329:function(e,t,a){a.d(t,{Ak:function(){return n}});let n=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>(t&=63,e+=t<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_",e),"")},89919:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});a(69439);var n=a(61462),u=a(20641),s=a(44329),r=a(50953),c=a(24943);const l={class:"account"},o=["src"];var i={__name:"index",setup(e){const t=(0,r.KR)(window.rubick.dbStorage.getItem("rubick-user-info")),a=(0,r.KR)(""),i=(0,s.Ak)(),d=(0,r.KR)(!1),v=()=>{d.value=!0,a.value||t.value||c.A.getScanCode({scene:i}).then(e=>{a.value=`data:image/png;base64,${e.dataUrl}`})};let b=null;return(0,u.wB)([d],()=>{d.value?b=setInterval(()=>{c.A.checkLoginStatus({scene:i}).then(e=>{console.log(e),e.openId&&(window.rubick.dbStorage.setItem("rubick-user-info",e),t.value=e,n["default"].success("登录成功！"),d.value=!1,clearInterval(b),b=null)})},2e3):(clearInterval(b),b=null)}),(e,n)=>{const s=(0,u.g2)("a-button"),r=(0,u.g2)("a-result"),c=(0,u.g2)("a-modal");return(0,u.uX)(),(0,u.CE)("div",l,[t.value?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.Wv)(r,{key:0,title:"请先登录","sub-title":"用户暂未登录，无法体验更多设置"},{extra:(0,u.k6)(()=>[(0,u.bF)(s,{type:"primary",onClick:v},{default:(0,u.k6)(()=>[...n[1]||(n[1]=[(0,u.eW)("使用微信小程序登录",-1)])]),_:1})]),_:1})),(0,u.bF)(c,{visible:d.value,"onUpdate:visible":n[0]||(n[0]=e=>d.value=e),footer:null},{default:(0,u.k6)(()=>[(0,u.bF)(r,{title:"请使用微信扫码登录!","sub-title":"使用微信扫描上面的 rubick 小程序二维码进行授权登录"},{icon:(0,u.k6)(()=>[(0,u.Lk)("img",{width:"200",src:a.value},null,8,o)]),_:1})]),_:1},8,["visible"])])}}},d=a(66262);const v=(0,d.A)(i,[["__scopeId","data-v-6728cdb2"]]);var b=v}}]);